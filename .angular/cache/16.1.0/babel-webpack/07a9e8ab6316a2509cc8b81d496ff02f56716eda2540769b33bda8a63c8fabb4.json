{"ast":null,"code":"import _asyncToGenerator from \"/Users/adrianfloresrangel/Angular/Gifs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpParams } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class GifsService {\n  constructor(http) {\n    this.http = http;\n    this.gifList = [];\n    this._tagHistory = [];\n    this.apiKey = 'l3td3q5t5dqLIW90Tl0pHBSdxXbtb9I0';\n    this.serviceUrl = 'https://api.giphy.com/v1/gifs';\n  }\n  get tagsHistory() {\n    return [...this._tagHistory];\n  }\n  organizeHistory(tag) {\n    tag = tag.toLowerCase();\n    if (this._tagHistory.includes(tag)) {\n      this._tagHistory = this._tagHistory.filter(oldTag => oldTag !== tag);\n    }\n    this._tagHistory.unshift(tag);\n    this._tagHistory = this.tagsHistory.splice(0, 10);\n    this.saveLocalStorage();\n  }\n  saveLocalStorage() {\n    localStorage.setItem('history', JSON.stringify(this._tagHistory));\n  }\n  loadLocalStorage() {\n    if (!localStorage.getItem('history')) return;\n    this._tagHistory = JSON.parse(localStorage.getItem('history'));\n    if (this._tagHistory.length === 0) return;\n    this.searchTag(this._tagHistory[0]);\n  }\n  searchTag(tag) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (tag.length === 0) return;\n      _this.organizeHistory(tag);\n      const params = new HttpParams().set('api_key', _this.apiKey).set('limit', '10').set('q', tag);\n      _this.http.get(`${_this.serviceUrl}/search`, {\n        params\n      }).subscribe(resp => {\n        _this.gifList = resp.data;\n        // console.log({gifs: this.gifList});\n      });\n    })();\n  }\n}\n\nGifsService.ɵfac = function GifsService_Factory(t) {\n  return new (t || GifsService)(i0.ɵɵinject(i1.HttpClient));\n};\nGifsService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: GifsService,\n  factory: GifsService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["HttpParams","GifsService","constructor","http","gifList","_tagHistory","apiKey","serviceUrl","tagsHistory","organizeHistory","tag","toLowerCase","includes","filter","oldTag","unshift","splice","saveLocalStorage","localStorage","setItem","JSON","stringify","loadLocalStorage","getItem","parse","length","searchTag","_this","_asyncToGenerator","params","set","get","subscribe","resp","data","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["/Users/adrianfloresrangel/Angular/Gifs/src/app/gifs/services/gifs.service.ts"],"sourcesContent":["import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { SearchResponse , Gif} from '../interfaces/gifs.interfaces';\n\n@Injectable({providedIn: 'root'})\nexport class GifsService {\n    public gifList : Gif[] = [];\n    private _tagHistory: string[] = [];\n    private apiKey: string = 'l3td3q5t5dqLIW90Tl0pHBSdxXbtb9I0';\n    private serviceUrl :string = 'https://api.giphy.com/v1/gifs';\n\n    constructor(private http: HttpClient) { }\n    \n    get tagsHistory(){\n        return [...this._tagHistory]\n    }\n\n    private organizeHistory(tag: string){\n        tag = tag.toLowerCase();\n\n        if(this._tagHistory.includes( tag ) ){\n            this._tagHistory = this._tagHistory.filter( (oldTag) => oldTag !== tag)\n        }\n        \n        this._tagHistory.unshift( tag );\n        this._tagHistory = this.tagsHistory.splice(0,10);\n        this.saveLocalStorage();\n    }\n\n    private saveLocalStorage():void{\n        localStorage.setItem('history',JSON.stringify(this._tagHistory));\n    }\n\n    private loadLocalStorage():void{\n        if(!localStorage.getItem('history')) return;\n\n        this._tagHistory=JSON.parse(localStorage.getItem('history')!);\n\n        if(this._tagHistory.length === 0) return;\n\n        this.searchTag( this._tagHistory[0]);\n    }\n\n    async searchTag(tag :string):Promise<void>{\n\n        if(tag.length === 0) return;\n        this.organizeHistory(tag);\n        const params = new HttpParams()\n        .set('api_key', this.apiKey)\n        .set('limit','10')\n        .set('q',tag)\n\n            this.http.get<SearchResponse>(`${ this.serviceUrl }/search`,{ params })\n           .subscribe( resp =>{\n                this.gifList = resp.data;\n               // console.log({gifs: this.gifList});\n           })\n    }\n}"],"mappings":";AAAA,SAAqBA,UAAU,QAAQ,sBAAsB;;;AAK7D,OAAM,MAAOC,WAAW;EAMpBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IALjB,KAAAC,OAAO,GAAW,EAAE;IACnB,KAAAC,WAAW,GAAa,EAAE;IAC1B,KAAAC,MAAM,GAAW,kCAAkC;IACnD,KAAAC,UAAU,GAAW,+BAA+B;EAEpB;EAExC,IAAIC,WAAWA,CAAA;IACX,OAAO,CAAC,GAAG,IAAI,CAACH,WAAW,CAAC;EAChC;EAEQI,eAAeA,CAACC,GAAW;IAC/BA,GAAG,GAAGA,GAAG,CAACC,WAAW,EAAE;IAEvB,IAAG,IAAI,CAACN,WAAW,CAACO,QAAQ,CAAEF,GAAG,CAAE,EAAE;MACjC,IAAI,CAACL,WAAW,GAAG,IAAI,CAACA,WAAW,CAACQ,MAAM,CAAGC,MAAM,IAAKA,MAAM,KAAKJ,GAAG,CAAC;;IAG3E,IAAI,CAACL,WAAW,CAACU,OAAO,CAAEL,GAAG,CAAE;IAC/B,IAAI,CAACL,WAAW,GAAG,IAAI,CAACG,WAAW,CAACQ,MAAM,CAAC,CAAC,EAAC,EAAE,CAAC;IAChD,IAAI,CAACC,gBAAgB,EAAE;EAC3B;EAEQA,gBAAgBA,CAAA;IACpBC,YAAY,CAACC,OAAO,CAAC,SAAS,EAACC,IAAI,CAACC,SAAS,CAAC,IAAI,CAAChB,WAAW,CAAC,CAAC;EACpE;EAEQiB,gBAAgBA,CAAA;IACpB,IAAG,CAACJ,YAAY,CAACK,OAAO,CAAC,SAAS,CAAC,EAAE;IAErC,IAAI,CAAClB,WAAW,GAACe,IAAI,CAACI,KAAK,CAACN,YAAY,CAACK,OAAO,CAAC,SAAS,CAAE,CAAC;IAE7D,IAAG,IAAI,CAAClB,WAAW,CAACoB,MAAM,KAAK,CAAC,EAAE;IAElC,IAAI,CAACC,SAAS,CAAE,IAAI,CAACrB,WAAW,CAAC,CAAC,CAAC,CAAC;EACxC;EAEMqB,SAASA,CAAChB,GAAW;IAAA,IAAAiB,KAAA;IAAA,OAAAC,iBAAA;MAEvB,IAAGlB,GAAG,CAACe,MAAM,KAAK,CAAC,EAAE;MACrBE,KAAI,CAAClB,eAAe,CAACC,GAAG,CAAC;MACzB,MAAMmB,MAAM,GAAG,IAAI7B,UAAU,EAAE,CAC9B8B,GAAG,CAAC,SAAS,EAAEH,KAAI,CAACrB,MAAM,CAAC,CAC3BwB,GAAG,CAAC,OAAO,EAAC,IAAI,CAAC,CACjBA,GAAG,CAAC,GAAG,EAACpB,GAAG,CAAC;MAETiB,KAAI,CAACxB,IAAI,CAAC4B,GAAG,CAAiB,GAAIJ,KAAI,CAACpB,UAAW,SAAS,EAAC;QAAEsB;MAAM,CAAE,CAAC,CACvEG,SAAS,CAAEC,IAAI,IAAG;QACdN,KAAI,CAACvB,OAAO,GAAG6B,IAAI,CAACC,IAAI;QACzB;MACJ,CAAC,CAAC;IAAA;EACT;;;AApDSjC,WAAW,C;mBAAXA,WAAW,EAAAkC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;AAAA;AAAXrC,WAAW,C;SAAXA,WAAW;EAAAsC,OAAA,EAAXtC,WAAW,CAAAuC,IAAA;EAAAC,UAAA,EADC;AAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}